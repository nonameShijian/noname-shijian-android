{"version":3,"file":"TimelineFlameChartView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/TimelineFlameChartView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Bindings from '../../models/bindings/bindings.js';\nimport * as TimelineModel from '../../models/timeline_model/timeline_model.js';\nimport * as TraceEngine from '../../models/trace/trace.js';\nimport * as PerfUI from '../../ui/legacy/components/perf_ui/perf_ui.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport {CountersGraph} from './CountersGraph.js';\n\nimport {Events as PerformanceModelEvents, type PerformanceModel, type WindowChangedEvent} from './PerformanceModel.js';\nimport {TimelineDetailsView} from './TimelineDetailsView.js';\nimport {TimelineRegExp} from './TimelineFilters.js';\nimport {\n  Events as TimelineFlameChartDataProviderEvents,\n  TimelineFlameChartDataProvider,\n} from './TimelineFlameChartDataProvider.js';\nimport {TimelineFlameChartNetworkDataProvider} from './TimelineFlameChartNetworkDataProvider.js';\n\nimport {type TimelineModeViewDelegate} from './TimelinePanel.js';\n\nimport {TimelineSelection} from './TimelineSelection.js';\nimport {AggregatedTimelineTreeView} from './TimelineTreeView.js';\n\nimport {TimelineUIUtils, type TimelineMarkerStyle} from './TimelineUIUtils.js';\n\nconst UIStrings = {\n  /**\n   *@description Text in Timeline Flame Chart View of the Performance panel\n   *@example {Frame} PH1\n   *@example {10ms} PH2\n   */\n  sAtS: '{PH1} at {PH2}',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/timeline/TimelineFlameChartView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport class TimelineFlameChartView extends UI.Widget.VBox implements PerfUI.FlameChart.FlameChartDelegate,\n                                                                      UI.SearchableView.Searchable {\n  private readonly delegate: TimelineModeViewDelegate;\n  private model: PerformanceModel|null;\n  private searchResults!: number[]|undefined;\n  private eventListeners: Common.EventTarget.EventDescriptor[];\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private readonly showMemoryGraphSetting: Common.Settings.Setting<any>;\n  private readonly networkSplitWidget: UI.SplitWidget.SplitWidget;\n  private mainDataProvider: TimelineFlameChartDataProvider;\n  private readonly mainFlameChart: PerfUI.FlameChart.FlameChart;\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private readonly networkFlameChartGroupExpansionSetting: Common.Settings.Setting<any>;\n  private networkDataProvider: TimelineFlameChartNetworkDataProvider;\n  private readonly networkFlameChart: PerfUI.FlameChart.FlameChart;\n  private readonly networkPane: UI.Widget.VBox;\n  private readonly splitResizer: HTMLElement;\n  private readonly chartSplitWidget: UI.SplitWidget.SplitWidget;\n  private readonly countersView: CountersGraph;\n  private readonly detailsSplitWidget: UI.SplitWidget.SplitWidget;\n  private readonly detailsView: TimelineDetailsView;\n  private readonly onMainEntrySelected: (event: Common.EventTarget.EventTargetEvent<number>) => void;\n  private readonly onNetworkEntrySelected: (event: Common.EventTarget.EventTargetEvent<number>) => void;\n  private readonly boundRefresh: () => void;\n  #selectedEvents: SDK.TracingModel.CompatibleTraceEvent[]|null;\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private readonly groupBySetting: Common.Settings.Setting<any>;\n  private searchableView!: UI.SearchableView.SearchableView;\n  private needsResizeToPreferredHeights?: boolean;\n  private selectedSearchResult?: number;\n  private searchRegex?: RegExp;\n  #traceEngineData: TraceEngine.Handlers.Migration.PartialTraceData|null;\n  #filmStripModel: SDK.FilmStripModel.FilmStripModel|null = null;\n\n  constructor(delegate: TimelineModeViewDelegate) {\n    super();\n    this.element.classList.add('timeline-flamechart');\n    this.delegate = delegate;\n    this.model = null;\n    this.eventListeners = [];\n    this.#traceEngineData = null;\n\n    this.showMemoryGraphSetting = Common.Settings.Settings.instance().createSetting('timelineShowMemory', false);\n\n    // Create main and network flamecharts.\n    this.networkSplitWidget = new UI.SplitWidget.SplitWidget(false, false, 'timelineFlamechartMainView', 150);\n\n    // Ensure that the network panel & resizer appears above the main thread.\n    this.networkSplitWidget.sidebarElement().style.zIndex = '120';\n\n    const mainViewGroupExpansionSetting =\n        Common.Settings.Settings.instance().createSetting('timelineFlamechartMainViewGroupExpansion', {});\n    this.mainDataProvider = new TimelineFlameChartDataProvider();\n    this.mainDataProvider.addEventListener(\n        TimelineFlameChartDataProviderEvents.DataChanged, () => this.mainFlameChart.scheduleUpdate());\n    this.mainFlameChart = new PerfUI.FlameChart.FlameChart(this.mainDataProvider, this, mainViewGroupExpansionSetting);\n    this.mainFlameChart.alwaysShowVerticalScroll();\n    this.mainFlameChart.enableRuler(false);\n\n    this.networkFlameChartGroupExpansionSetting =\n        Common.Settings.Settings.instance().createSetting('timelineFlamechartNetworkViewGroupExpansion', {});\n    this.networkDataProvider = new TimelineFlameChartNetworkDataProvider();\n    this.networkFlameChart =\n        new PerfUI.FlameChart.FlameChart(this.networkDataProvider, this, this.networkFlameChartGroupExpansionSetting);\n    this.networkFlameChart.alwaysShowVerticalScroll();\n\n    this.networkPane = new UI.Widget.VBox();\n    this.networkPane.setMinimumSize(23, 23);\n    this.networkFlameChart.show(this.networkPane.element);\n    this.splitResizer = this.networkPane.element.createChild('div', 'timeline-flamechart-resizer');\n    this.networkSplitWidget.hideDefaultResizer(true);\n    this.networkSplitWidget.installResizer(this.splitResizer);\n    this.networkSplitWidget.setMainWidget(this.mainFlameChart);\n    this.networkSplitWidget.setSidebarWidget(this.networkPane);\n\n    // Create counters chart splitter.\n    this.chartSplitWidget = new UI.SplitWidget.SplitWidget(false, true, 'timelineCountersSplitViewState');\n    this.countersView = new CountersGraph(this.delegate);\n    this.chartSplitWidget.setMainWidget(this.networkSplitWidget);\n    this.chartSplitWidget.setSidebarWidget(this.countersView);\n    this.chartSplitWidget.hideDefaultResizer();\n    this.chartSplitWidget.installResizer((this.countersView.resizerElement() as Element));\n    this.updateCountersGraphToggle();\n\n    // Create top level properties splitter.\n    this.detailsSplitWidget = new UI.SplitWidget.SplitWidget(false, true, 'timelinePanelDetailsSplitViewState');\n    this.detailsSplitWidget.element.classList.add('timeline-details-split');\n    this.detailsView = new TimelineDetailsView(delegate);\n    this.detailsSplitWidget.installResizer(this.detailsView.headerElement());\n    this.detailsSplitWidget.setMainWidget(this.chartSplitWidget);\n    this.detailsSplitWidget.setSidebarWidget(this.detailsView);\n    this.detailsSplitWidget.show(this.element);\n\n    this.onMainEntrySelected = this.onEntrySelected.bind(this, this.mainDataProvider);\n    this.onNetworkEntrySelected = this.onEntrySelected.bind(this, this.networkDataProvider);\n    this.mainFlameChart.addEventListener(PerfUI.FlameChart.Events.EntrySelected, this.onMainEntrySelected, this);\n    this.mainFlameChart.addEventListener(PerfUI.FlameChart.Events.EntryInvoked, this.onMainEntrySelected, this);\n    this.networkFlameChart.addEventListener(PerfUI.FlameChart.Events.EntrySelected, this.onNetworkEntrySelected, this);\n    this.networkFlameChart.addEventListener(PerfUI.FlameChart.Events.EntryInvoked, this.onNetworkEntrySelected, this);\n    this.mainFlameChart.addEventListener(PerfUI.FlameChart.Events.EntryHighlighted, this.onEntryHighlighted, this);\n\n    this.boundRefresh = this.refresh.bind(this);\n    this.#selectedEvents = null;\n\n    this.mainDataProvider.setEventColorMapping(TimelineUIUtils.eventColor);\n    this.groupBySetting = Common.Settings.Settings.instance().createSetting(\n        'timelineTreeGroupBy', AggregatedTimelineTreeView.GroupBy.None);\n    this.groupBySetting.addChangeListener(this.updateColorMapper, this);\n    this.updateColorMapper();\n  }\n\n  isNetworkTrackShownForTests(): boolean {\n    return this.networkSplitWidget.showMode() !== UI.SplitWidget.ShowMode.OnlyMain;\n  }\n\n  updateColorMapper(): void {\n    if (!this.model) {\n      return;\n    }\n    this.mainDataProvider.setEventColorMapping(TimelineUIUtils.eventColor);\n    this.mainFlameChart.update();\n  }\n\n  private onWindowChanged(event: Common.EventTarget.EventTargetEvent<WindowChangedEvent>): void {\n    const {window, animate} = event.data;\n    this.mainFlameChart.setWindowTimes(window.left, window.right, animate);\n    this.networkFlameChart.setWindowTimes(window.left, window.right, animate);\n    this.networkDataProvider.setWindowTimes(window.left, window.right);\n    this.updateSearchResults(false, false);\n  }\n\n  windowChanged(windowStartTime: number, windowEndTime: number, animate: boolean): void {\n    if (this.model) {\n      this.model.setWindow({left: windowStartTime, right: windowEndTime}, animate);\n    }\n  }\n\n  updateRangeSelection(startTime: number, endTime: number): void {\n    this.delegate.select(TimelineSelection.fromRange(startTime, endTime));\n  }\n\n  updateSelectedGroup(flameChart: PerfUI.FlameChart.FlameChart, group: PerfUI.FlameChart.Group|null): void {\n    if (flameChart !== this.mainFlameChart) {\n      return;\n    }\n    this.#selectedEvents = group ? this.mainDataProvider.groupTreeEvents(group) : null;\n    this.updateTrack();\n  }\n\n  setModel(\n      model: PerformanceModel|null, newTraceEngineData: TraceEngine.Handlers.Migration.PartialTraceData|null,\n      filmStripModel: SDK.FilmStripModel.FilmStripModel|null): void {\n    if (model === this.model) {\n      return;\n    }\n    this.#filmStripModel = filmStripModel;\n    this.#traceEngineData = newTraceEngineData;\n    Common.EventTarget.removeEventListeners(this.eventListeners);\n    this.model = model;\n    this.#selectedEvents = null;\n    this.mainDataProvider.setModel(this.model, newTraceEngineData);\n    this.networkDataProvider.setModel(this.model, newTraceEngineData);\n    if (this.model) {\n      this.eventListeners = [\n        this.model.addEventListener(PerformanceModelEvents.WindowChanged, this.onWindowChanged, this),\n      ];\n      const window = this.model.window();\n      this.mainFlameChart.setWindowTimes(window.left, window.right);\n      this.networkFlameChart.setWindowTimes(window.left, window.right);\n      this.networkDataProvider.setWindowTimes(window.left, window.right);\n      this.updateSearchResults(false, false);\n    }\n    this.updateColorMapper();\n    this.updateTrack();\n    this.refresh();\n  }\n\n  private updateTrack(): void {\n    this.countersView.setModel(this.model, this.#selectedEvents);\n    this.detailsView.setModel(this.model, this.#traceEngineData, this.#filmStripModel, this.#selectedEvents);\n  }\n\n  private refresh(): void {\n    if (this.networkDataProvider.isEmpty()) {\n      this.mainFlameChart.enableRuler(true);\n      this.networkSplitWidget.hideSidebar();\n    } else {\n      this.mainFlameChart.enableRuler(false);\n      this.networkSplitWidget.showBoth();\n      this.resizeToPreferredHeights();\n    }\n    this.mainFlameChart.reset();\n    this.networkFlameChart.reset();\n    this.updateSearchResults(false, false);\n  }\n\n  private onEntryHighlighted(commonEvent: Common.EventTarget.EventTargetEvent<number>): void {\n    SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n    const entryIndex = commonEvent.data;\n    // TODO(crbug.com/1431166): explore how we can make highlighting agnostic\n    // and take either legacy events, or new trace engine events. Currently if\n    // this highlight comes from a TrackAppender, we create a new legacy event\n    // from the event payload, mainly to satisfy this method.\n    const event = this.mainDataProvider.eventByIndex(entryIndex);\n    if (!event) {\n      return;\n    }\n    const target = this.model && this.model.timelineModel().targetByEvent(event);\n    if (!target) {\n      return;\n    }\n    let backendNodeIds;\n\n    // Events for tracks that are migrated to the new engine won't use\n    // TimelineModel.TimelineData.\n    if (event instanceof SDK.TracingModel.Event) {\n      const timelineData = TimelineModel.TimelineModel.EventOnTimelineData.forEvent(event);\n      backendNodeIds = timelineData.backendNodeIds;\n    } else if (TraceEngine.Types.TraceEvents.isTraceEventLayoutShift(event)) {\n      const impactedNodes = event.args.data?.impacted_nodes ?? [];\n      backendNodeIds = impactedNodes.map(node => node.node_id);\n    }\n\n    if (!backendNodeIds) {\n      return;\n    }\n    for (let i = 0; i < backendNodeIds.length; ++i) {\n      new SDK.DOMModel.DeferredDOMNode(target, backendNodeIds[i]).highlight();\n    }\n  }\n\n  highlightEvent(event: SDK.TracingModel.Event|null): void {\n    const entryIndex =\n        event ? this.mainDataProvider.entryIndexForSelection(TimelineSelection.fromTraceEvent(event)) : -1;\n    if (entryIndex >= 0) {\n      this.mainFlameChart.highlightEntry(entryIndex);\n    } else {\n      this.mainFlameChart.hideHighlight();\n    }\n  }\n\n  override willHide(): void {\n    this.networkFlameChartGroupExpansionSetting.removeChangeListener(this.resizeToPreferredHeights, this);\n    this.showMemoryGraphSetting.removeChangeListener(this.updateCountersGraphToggle, this);\n    Bindings.IgnoreListManager.IgnoreListManager.instance().removeChangeListener(this.boundRefresh);\n  }\n\n  override wasShown(): void {\n    this.networkFlameChartGroupExpansionSetting.addChangeListener(this.resizeToPreferredHeights, this);\n    this.showMemoryGraphSetting.addChangeListener(this.updateCountersGraphToggle, this);\n    Bindings.IgnoreListManager.IgnoreListManager.instance().addChangeListener(this.boundRefresh);\n    if (this.needsResizeToPreferredHeights) {\n      this.resizeToPreferredHeights();\n    }\n    this.mainFlameChart.scheduleUpdate();\n    this.networkFlameChart.scheduleUpdate();\n  }\n\n  private updateCountersGraphToggle(): void {\n    if (this.showMemoryGraphSetting.get()) {\n      this.chartSplitWidget.showBoth();\n    } else {\n      this.chartSplitWidget.hideSidebar();\n    }\n  }\n\n  setSelection(selection: TimelineSelection|null): void {\n    let index = this.mainDataProvider.entryIndexForSelection(selection);\n    this.mainFlameChart.setSelectedEntry(index);\n    index = this.networkDataProvider.entryIndexForSelection(selection);\n    this.networkFlameChart.setSelectedEntry(index);\n    if (this.detailsView) {\n      this.detailsView.setSelection(selection);\n    }\n  }\n\n  private onEntrySelected(\n      dataProvider: PerfUI.FlameChart.FlameChartDataProvider,\n      event: Common.EventTarget.EventTargetEvent<number>): void {\n    const entryIndex = event.data;\n    if (Root.Runtime.experiments.isEnabled('timelineEventInitiators') && dataProvider === this.mainDataProvider) {\n      if (this.mainDataProvider.buildFlowForInitiator(entryIndex)) {\n        this.mainFlameChart.scheduleUpdate();\n      }\n    }\n    this.delegate.select((dataProvider as TimelineFlameChartNetworkDataProvider | TimelineFlameChartDataProvider)\n                             .createSelection(entryIndex));\n  }\n\n  resizeToPreferredHeights(): void {\n    if (!this.isShowing()) {\n      this.needsResizeToPreferredHeights = true;\n      return;\n    }\n    this.needsResizeToPreferredHeights = false;\n    this.networkPane.element.classList.toggle(\n        'timeline-network-resizer-disabled', !this.networkDataProvider.isExpanded());\n    this.networkSplitWidget.setSidebarSize(\n        this.networkDataProvider.preferredHeight() + this.splitResizer.clientHeight + PerfUI.FlameChart.HeaderHeight +\n        2);\n  }\n\n  setSearchableView(searchableView: UI.SearchableView.SearchableView): void {\n    this.searchableView = searchableView;\n  }\n\n  // UI.SearchableView.Searchable implementation\n\n  jumpToNextSearchResult(): void {\n    if (!this.searchResults || !this.searchResults.length) {\n      return;\n    }\n    const index =\n        typeof this.selectedSearchResult !== 'undefined' ? this.searchResults.indexOf(this.selectedSearchResult) : -1;\n    this.selectSearchResult(Platform.NumberUtilities.mod(index + 1, this.searchResults.length));\n  }\n\n  jumpToPreviousSearchResult(): void {\n    if (!this.searchResults || !this.searchResults.length) {\n      return;\n    }\n    const index =\n        typeof this.selectedSearchResult !== 'undefined' ? this.searchResults.indexOf(this.selectedSearchResult) : 0;\n    this.selectSearchResult(Platform.NumberUtilities.mod(index - 1, this.searchResults.length));\n  }\n\n  supportsCaseSensitiveSearch(): boolean {\n    return true;\n  }\n\n  supportsRegexSearch(): boolean {\n    return true;\n  }\n\n  private selectSearchResult(index: number): void {\n    this.searchableView.updateCurrentMatchIndex(index);\n    if (this.searchResults) {\n      this.selectedSearchResult = this.searchResults[index];\n      this.delegate.select(this.mainDataProvider.createSelection(this.selectedSearchResult));\n    }\n  }\n\n  private updateSearchResults(shouldJump: boolean, jumpBackwards?: boolean): void {\n    const oldSelectedSearchResult = (this.selectedSearchResult as number);\n    delete this.selectedSearchResult;\n    this.searchResults = [];\n    if (!this.searchRegex || !this.model) {\n      return;\n    }\n    const regExpFilter = new TimelineRegExp(this.searchRegex);\n    const window = this.model.window();\n    this.searchResults = this.mainDataProvider.search(window.left, window.right, regExpFilter);\n    this.searchableView.updateSearchMatchesCount(this.searchResults.length);\n    if (!shouldJump || !this.searchResults.length) {\n      return;\n    }\n    let selectedIndex = this.searchResults.indexOf(oldSelectedSearchResult);\n    if (selectedIndex === -1) {\n      selectedIndex = jumpBackwards ? this.searchResults.length - 1 : 0;\n    }\n    this.selectSearchResult(selectedIndex);\n  }\n\n  /**\n   * Returns the indexes of the elements that matched the most recent\n   * query. Elements are indexed by the data provider and correspond\n   * to their position in the data provider entry data array.\n   * Public only for tests.\n   */\n  getSearchResults(): number[]|undefined {\n    return this.searchResults;\n  }\n\n  onSearchCanceled(): void {\n    if (typeof this.selectedSearchResult !== 'undefined') {\n      this.delegate.select(null);\n    }\n    delete this.searchResults;\n    delete this.selectedSearchResult;\n    delete this.searchRegex;\n  }\n\n  performSearch(searchConfig: UI.SearchableView.SearchConfig, shouldJump: boolean, jumpBackwards?: boolean): void {\n    this.searchRegex = searchConfig.toSearchRegex().regex;\n    this.updateSearchResults(shouldJump, jumpBackwards);\n  }\n}\n\nexport class Selection {\n  timelineSelection: TimelineSelection;\n  entryIndex: number;\n  constructor(selection: TimelineSelection, entryIndex: number) {\n    this.timelineSelection = selection;\n    this.entryIndex = entryIndex;\n  }\n}\n\nexport const FlameChartStyle = {\n  textColor: '#333',\n};\n\nexport class TimelineFlameChartMarker implements PerfUI.FlameChart.FlameChartMarker {\n  private readonly startTimeInternal: number;\n  private readonly startOffset: number;\n  private style: TimelineMarkerStyle;\n  constructor(startTime: number, startOffset: number, style: TimelineMarkerStyle) {\n    this.startTimeInternal = startTime;\n    this.startOffset = startOffset;\n    this.style = style;\n  }\n\n  startTime(): number {\n    return this.startTimeInternal;\n  }\n\n  color(): string {\n    return this.style.color;\n  }\n\n  title(): string|null {\n    if (this.style.lowPriority) {\n      return null;\n    }\n    const startTime = i18n.TimeUtilities.millisToString(this.startOffset);\n    return i18nString(UIStrings.sAtS, {PH1: this.style.title, PH2: startTime});\n  }\n\n  draw(context: CanvasRenderingContext2D, x: number, height: number, pixelsPerMillisecond: number): void {\n    const lowPriorityVisibilityThresholdInPixelsPerMs = 4;\n\n    if (this.style.lowPriority && pixelsPerMillisecond < lowPriorityVisibilityThresholdInPixelsPerMs) {\n      return;\n    }\n\n    context.save();\n    if (this.style.tall) {\n      context.strokeStyle = this.style.color;\n      context.lineWidth = this.style.lineWidth;\n      context.translate(this.style.lineWidth < 1 || (this.style.lineWidth & 1) ? 0.5 : 0, 0.5);\n      context.beginPath();\n      context.moveTo(x, 0);\n      context.setLineDash(this.style.dashStyle);\n      context.lineTo(x, context.canvas.height);\n      context.stroke();\n    }\n    context.restore();\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum ColorBy {\n  URL = 'URL',\n}\n"]}